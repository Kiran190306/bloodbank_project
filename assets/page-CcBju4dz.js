import{C as r}from"./PolymorphicComponent-CPB_qS69.js";import{r as n,o as e,p as A}from"./chunk-JMJ3UQ3L-NvGUjwXk.js";import{D as F,R as E}from"./droplet-DzP8lk1O.js";import{u as q}from"./useUser-DbfjEQt0.js";import"./react-Cn0hViU7.js";if(typeof window<"u"){const t={};globalThis.process??(globalThis.process={});const d=globalThis.process.env??{};globalThis.process.env=new Proxy(Object.assign({},t,d),{get(o,l){return l in o?o[l]:void 0},has(){return!0}})}function U(){const{data:t,loading:d}=q(),[o,l]=n.useState(!1),[p,m]=n.useState(null),[x,C]=n.useState(!1),[i,k]=n.useState("donor"),[b,h]=n.useState(""),[g,T]=n.useState(""),[y,P]=n.useState(""),[c,j]=n.useState(""),[u,N]=n.useState(""),[f,v]=n.useState(""),[I,B]=n.useState(""),[w,O]=n.useState("");n.useEffect(()=>{if(typeof window<"u"){const s=localStorage.getItem("pendingUserType"),a=localStorage.getItem("pendingFullName");s&&k(s),a&&h(a)}},[]),n.useEffect(()=>{d||(async()=>{if(!t)return;const a=await fetch("/api/profile");a.ok&&(await a.json()).userProfile&&(window.location.href="/dashboard")})()},[t,d]);const R=async s=>{s.preventDefault(),l(!0),m(null);try{if(!(await fetch("/api/profile",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({full_name:b,phone:g,user_type:i})})).ok)throw new Error("Failed to create profile");if(i==="donor"){if(!(await fetch("/api/donors",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({blood_group:y,city:c,state:u,address:f})})).ok)throw new Error("Failed to create donor profile")}else if(i==="hospital"&&!(await fetch("/api/blood-banks",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({hospital_name:I,registration_number:w,address:f,city:c,state:u,phone:g})})).ok)throw new Error("Failed to create hospital profile");localStorage.removeItem("pendingUserType"),localStorage.removeItem("pendingFullName"),C(!0),setTimeout(()=>{window.location.href="/dashboard"},1500)}catch(a){console.error(a),m(a.message||"Something went wrong"),l(!1)}};return d?e.jsx(r,{className:"flex min-h-screen items-center justify-center",renderId:"render-b09befb3",as:"div",children:e.jsx(r,{className:"text-gray-600",renderId:"render-01ded9cf",as:"div",children:"Loading..."})}):t?e.jsx(r,{className:"flex min-h-screen w-full items-center justify-center bg-gradient-to-br from-red-50 to-white p-4",renderId:"render-84e515b9",as:"div",children:e.jsxs(r,{onSubmit:R,className:"w-full max-w-2xl rounded-2xl bg-white p-8 shadow-xl border border-gray-100",renderId:"render-eeef18c6",as:"form",children:[e.jsx(r,{className:"flex items-center justify-center mb-6",renderId:"render-eedb3a85",as:"div",children:e.jsx(r,{className:"bg-red-600 p-3 rounded-full",renderId:"render-d42119b4",as:"div",children:e.jsx(F,{className:"w-8 h-8 text-white"})})}),e.jsx(r,{className:"mb-2 text-center text-3xl font-bold text-gray-800",renderId:"render-2069b287",as:"h1",children:"Complete Your Profile"}),e.jsx(r,{className:"mb-8 text-center text-gray-600",renderId:"render-39f3b0d0",as:"p",children:"Tell us a bit more about yourself"}),e.jsxs(r,{className:"space-y-6",renderId:"render-9311e9ef",as:"div",children:[e.jsxs(r,{className:"grid md:grid-cols-2 gap-4",renderId:"render-7aef6721",as:"div",children:[e.jsxs(r,{className:"space-y-2",renderId:"render-0b948a6a",as:"div",children:[e.jsx(r,{className:"block text-sm font-medium text-gray-700",renderId:"render-69912192",as:"label",children:"Full Name"}),e.jsx(r,{required:!0,type:"text",value:b,onChange:s=>h(s.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500",renderId:"render-4c6b3be1",as:"input"})]}),e.jsxs(r,{className:"space-y-2",renderId:"render-7f22c0f5",as:"div",children:[e.jsx(r,{className:"block text-sm font-medium text-gray-700",renderId:"render-6a1f9266",as:"label",children:"Phone Number"}),e.jsx(r,{required:!0,type:"tel",value:g,onChange:s=>T(s.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500",renderId:"render-7a5ac9c5",as:"input"})]})]}),i==="donor"&&e.jsxs(e.Fragment,{children:[e.jsxs(r,{className:"grid md:grid-cols-2 gap-4",renderId:"render-33a6dc07",as:"div",children:[e.jsxs(r,{className:"space-y-2",renderId:"render-cc1474f0",as:"div",children:[e.jsx(r,{className:"block text-sm font-medium text-gray-700",renderId:"render-c7e5123b",as:"label",children:"Blood Group"}),e.jsxs(r,{required:!0,value:y,onChange:s=>P(s.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500",renderId:"render-8974e3c6",as:"select",children:[e.jsx(r,{value:"",renderId:"render-aecfdbff",as:"option",children:"Select Blood Group"}),e.jsx(r,{value:"A+",renderId:"render-277ac89c",as:"option",children:"A+"}),e.jsx(r,{value:"A-",renderId:"render-b5a4f5c8",as:"option",children:"A-"}),e.jsx(r,{value:"B+",renderId:"render-b53ac43c",as:"option",children:"B+"}),e.jsx(r,{value:"B-",renderId:"render-fd6066d1",as:"option",children:"B-"}),e.jsx(r,{value:"AB+",renderId:"render-865f60a1",as:"option",children:"AB+"}),e.jsx(r,{value:"AB-",renderId:"render-81e1d9d8",as:"option",children:"AB-"}),e.jsx(r,{value:"O+",renderId:"render-01e87aaa",as:"option",children:"O+"}),e.jsx(r,{value:"O-",renderId:"render-c49ac4ac",as:"option",children:"O-"})]})]}),e.jsxs(r,{className:"space-y-2",renderId:"render-9ee9ce45",as:"div",children:[e.jsx(r,{className:"block text-sm font-medium text-gray-700",renderId:"render-ce832cc1",as:"label",children:"City"}),e.jsx(r,{required:!0,type:"text",value:c,onChange:s=>j(s.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500",renderId:"render-ce3cff47",as:"input"})]})]}),e.jsxs(r,{className:"grid md:grid-cols-2 gap-4",renderId:"render-f41de5cf",as:"div",children:[e.jsxs(r,{className:"space-y-2",renderId:"render-01b5f3cb",as:"div",children:[e.jsx(r,{className:"block text-sm font-medium text-gray-700",renderId:"render-18ffdf45",as:"label",children:"State"}),e.jsx(r,{type:"text",value:u,onChange:s=>N(s.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500",renderId:"render-16e3c746",as:"input"})]}),e.jsxs(r,{className:"space-y-2",renderId:"render-1b092613",as:"div",children:[e.jsx(r,{className:"block text-sm font-medium text-gray-700",renderId:"render-58fc5789",as:"label",children:"Address"}),e.jsx(r,{type:"text",value:f,onChange:s=>v(s.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500",renderId:"render-ac3befbb",as:"input"})]})]})]}),i==="hospital"&&e.jsxs(e.Fragment,{children:[e.jsxs(r,{className:"grid md:grid-cols-2 gap-4",renderId:"render-0f43b132",as:"div",children:[e.jsxs(r,{className:"space-y-2",renderId:"render-da0419cb",as:"div",children:[e.jsx(r,{className:"block text-sm font-medium text-gray-700",renderId:"render-2f1c3470",as:"label",children:"Hospital/Blood Bank Name"}),e.jsx(r,{required:!0,type:"text",value:I,onChange:s=>B(s.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500",renderId:"render-86351f21",as:"input"})]}),e.jsxs(r,{className:"space-y-2",renderId:"render-6e9b9f92",as:"div",children:[e.jsx(r,{className:"block text-sm font-medium text-gray-700",renderId:"render-620896bc",as:"label",children:"Registration Number"}),e.jsx(r,{type:"text",value:w,onChange:s=>O(s.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500",renderId:"render-4d9fbc82",as:"input"})]})]}),e.jsxs(r,{className:"space-y-2",renderId:"render-163f948b",as:"div",children:[e.jsx(r,{className:"block text-sm font-medium text-gray-700",renderId:"render-a8d37585",as:"label",children:"Address"}),e.jsx(r,{required:!0,type:"text",value:f,onChange:s=>v(s.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500",renderId:"render-3c741f3e",as:"input"})]}),e.jsxs(r,{className:"grid md:grid-cols-2 gap-4",renderId:"render-ef0f9be4",as:"div",children:[e.jsxs(r,{className:"space-y-2",renderId:"render-6f9b83eb",as:"div",children:[e.jsx(r,{className:"block text-sm font-medium text-gray-700",renderId:"render-77965ef4",as:"label",children:"City"}),e.jsx(r,{required:!0,type:"text",value:c,onChange:s=>j(s.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500",renderId:"render-82083c68",as:"input"})]}),e.jsxs(r,{className:"space-y-2",renderId:"render-4129daac",as:"div",children:[e.jsx(r,{className:"block text-sm font-medium text-gray-700",renderId:"render-1faa041a",as:"label",children:"State"}),e.jsx(r,{type:"text",value:u,onChange:s=>N(s.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500",renderId:"render-11b914a2",as:"input"})]})]})]}),p&&e.jsx(r,{className:"rounded-lg bg-red-50 p-3 text-sm text-red-600 border border-red-200",renderId:"render-272d60e2",as:"div",children:p}),x&&e.jsx(r,{className:"rounded-lg bg-green-50 p-3 text-sm text-green-600 border border-green-200",renderId:"render-2e778f34",as:"div",children:"Profile created successfully! Redirecting..."}),e.jsx(r,{type:"submit",disabled:o||x,className:"w-full rounded-lg bg-red-600 px-4 py-3 text-base font-medium text-white transition-colors hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 disabled:opacity-50",renderId:"render-903c7967",as:"button",children:o?"Creating profile...":"Complete Profile"})]})]})}):(typeof window<"u"&&(window.location.href="/account/signin"),null)}if(typeof window<"u"){const t={};globalThis.process??(globalThis.process={});const d=globalThis.process.env??{};globalThis.process.env=new Proxy(Object.assign({},t,d),{get(o,l){return l in o?o[l]:void 0},has(){return!0}})}const H=A(function(d){return e.jsx(E,{children:e.jsx(U,{...d})})});export{H as default};
